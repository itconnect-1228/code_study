# TASK-092: AI 문서 생성을 위한 프롬프트 템플릿 구현

**작성일**: 2025-12-26
**상태**: 완료
**관련 파일**: `backend/src/services/ai/prompts.py`

## 무엇을 만들었나요?

AI가 코드를 분석해서 초보자를 위한 7장짜리 학습 문서를 만들 때 사용하는 "질문 템플릿"을 만들었습니다.

마치 요리사에게 레시피를 주는 것처럼, AI에게 "이런 형식으로 설명해줘"라고 알려주는 설계도입니다. 이 템플릿이 있어야 AI가 매번 일관된 형식으로 학습 자료를 만들 수 있습니다.

## 왜 이렇게 만들었나요?

초보자를 위한 학습 플랫폼이기 때문에, AI가 만든 설명이 반드시:
1. **전문 용어 없이** 일상 언어로 작성되어야 합니다
2. **실생활 비유**가 포함되어야 합니다 (예: "변수는 이름표가 붙은 상자 같은 것")
3. **7개 챕터**로 체계적으로 구성되어야 합니다
4. **줄별 설명**이 포함되어야 합니다

이 요구사항들이 프롬프트에 명확하게 포함되어야 AI가 일관된 품질의 콘텐츠를 생성합니다.

## 어떻게 작동하나요?

### 3가지 프롬프트 빌더

1. **PromptBuilder**: 7장 학습 문서 생성용
   - 코드와 언어 정보를 받아서 완전한 프롬프트 생성
   - JSON 형식의 응답 구조 정의

2. **PracticePromptBuilder**: 연습 문제 5개 생성용
   - 따라하기 → 빈칸채우기 → 수정하기 → 디버그 → 새로 만들기
   - 난이도가 점진적으로 올라가는 구조

3. **QAPromptBuilder**: Q&A 답변 생성용
   - 사용자의 질문에 맞춤형 답변 생성
   - 대화 기록을 고려한 맥락 인식 답변

### 7장 문서 구조

| 챕터 | 내용 | 목적 |
|------|------|------|
| 1장 | 한 문장 요약 | 코드가 뭘 하는지 간단히 |
| 2장 | 사전 지식 (최대 5개) | 이해에 필요한 개념들 |
| 3장 | 코드 구조 | 실행 흐름 시각화 |
| 4장 | 줄별 설명 | 각 줄이 하는 일 |
| 5장 | 실행 시뮬레이션 | 데이터가 어떻게 흐르는지 |
| 6장 | 핵심 개념 정리 | 배운 개념 요약 |
| 7장 | 흔한 실수들 | 초보자가 자주 하는 실수 3-5개 |

## 어떻게 테스트했나요?

```python
# 실제 테스트 코드
from src.services.ai.prompts import PromptBuilder

builder = PromptBuilder(
    code='def hello():\n    print("Hello, World!")',
    language='Python',
    filename='hello.py'
)

# 시스템 지시문 테스트
system_inst = builder.get_system_instruction()
# 결과: 1069자의 상세한 교육 지침

# 문서 프롬프트 테스트
prompt = builder.build_document_prompt()
# 결과: 5902자의 완전한 프롬프트 (7장 모두 포함)
```

## 수정된 파일들

1. **생성**: `backend/src/services/ai/prompts.py` (485줄)
   - PromptBuilder, PracticePromptBuilder, QAPromptBuilder 클래스
   - 시스템 지시문 상수들
   - JSON 스키마 정의
   - 편의 함수들

2. **수정**: `backend/src/services/ai/__init__.py`
   - prompts 모듈에서 내보내기 추가

## 관련 개념 설명

### 프롬프트 엔지니어링
AI에게 원하는 결과를 얻기 위해 질문을 잘 구성하는 기술입니다. 마치 좋은 질문을 하면 좋은 답변을 얻는 것처럼, AI에게도 명확하고 구체적인 지시를 주면 더 좋은 결과를 얻습니다.

### 시스템 지시문 (System Instruction)
AI의 "성격"을 정의하는 텍스트입니다. "당신은 친절한 프로그래밍 선생님입니다"처럼 AI가 어떤 역할을 해야 하는지 알려줍니다.

### JSON 스키마
AI 응답의 "형식"을 정의합니다. 마치 서류 양식처럼, "이 칸에는 이런 정보가 들어가야 해"라고 정해두는 것입니다.

## 주의할 점

1. **토큰 제한**: Gemini API는 한 번에 처리할 수 있는 텍스트 양에 제한이 있습니다. 너무 긴 코드는 프롬프트가 커져서 문제가 될 수 있습니다.

2. **일관성**: 프롬프트를 수정하면 모든 사용자의 문서 형식이 바뀝니다. 변경 시 주의가 필요합니다.

3. **언어 설정**: 현재 설명은 영어로 생성됩니다. 한국어 설명이 필요하면 프롬프트를 수정해야 합니다.

## 다음 단계

- **T093**: DocumentGenerationService 구현 (이 프롬프트를 실제로 사용하는 서비스)
- **T094**: Celery 비동기 작업 구현 (문서 생성이 오래 걸리므로 백그라운드에서 처리)

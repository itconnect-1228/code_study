# Task 014: FastAPI μ•± μ΄κΈ°ν™” λ° μ„¤μ •

**μ‘μ„±μΌ**: 2025-11-19
**μ‘μ—… μ ν•**: λ°±μ—”λ“ μΈν”„λΌ κµ¬μ¶•
**κ΄€λ ¨ νμΌ**:
- `backend/src/main.py` (μƒμ„±)
- `backend/tests/unit/test_main.py` (μƒμ„±)

---

## λ¬΄μ—‡μ„ λ§λ“¤μ—λ‚μ”?

μ›Ή μ• ν”λ¦¬μΌ€μ΄μ…μ μ¤‘μ‹¬μ΄ λλ” FastAPI μ„λ²„λ¥Ό λ§λ“¤μ—μµλ‹λ‹¤. μ΄κ²ƒμ€ λ§μΉ μ‹λ‹Ήμ μ£Όλ°©κ³Ό κ°™μ€ μ—­ν• μ„ ν•©λ‹λ‹¤. μ†λ‹(ν”„λ΅ νΈμ—”λ“)μ΄ μ£Όλ¬Έ(μ”μ²­)μ„ ν•λ©΄, μ£Όλ°©(λ°±μ—”λ“)μ—μ„ μ”λ¦¬(λ°μ΄ν„° μ²λ¦¬)λ¥Ό ν•΄μ„ λ‚΄μ–΄μ£Όλ” μ‹μ¤ν…μ κΈ°λ°μ„ κµ¬μ¶•ν–μµλ‹λ‹¤.

μ£Όμ” κΈ°λ¥:
1. **μ•± μƒμ„±**: FastAPI μ• ν”λ¦¬μΌ€μ΄μ… μΈμ¤ν„΄μ¤λ¥Ό λ§λ“¤μ—μµλ‹λ‹¤
2. **CORS μ„¤μ •**: λ‹¤λ¥Έ μ£Όμ†(ν¬νΈ)μ—μ„ μ‹¤ν–‰λλ” ν”„λ΅ νΈμ—”λ“κ°€ λ°±μ—”λ“μ™€ ν†µμ‹ ν•  μ μλ„λ΅ ν—μ©ν–μµλ‹λ‹¤
3. **ν—¬μ¤ μ²΄ν¬**: μ„λ²„κ°€ μ •μƒμ μΌλ΅ μ‘λ™ν•λ”μ§€ ν™•μΈν•  μ μλ” μ—”λ“ν¬μΈνΈλ¥Ό λ§λ“¤μ—μµλ‹λ‹¤
4. **λ£¨νΈ μ—”λ“ν¬μΈνΈ**: API μ •λ³΄λ¥Ό μ κ³µν•λ” κΈ°λ³Έ μ—”λ“ν¬μΈνΈλ¥Ό λ§λ“¤μ—μµλ‹λ‹¤

---

## μ™ μ΄λ ‡κ² λ§λ“¤μ—λ‚μ”?

### CORSκ°€ ν•„μ”ν• μ΄μ 
μ›Ή λΈλΌμ°μ €μ—λ” 'κ°™μ€ μ¶μ² μ •μ±…'μ΄λΌλ” λ³΄μ• κ·μΉ™μ΄ μμµλ‹λ‹¤. μλ¥Ό λ“¤μ–΄, `http://localhost:5173`μ—μ„ μ‹¤ν–‰λλ” ν”„λ΅ νΈμ—”λ“κ°€ `http://localhost:8000`μ—μ„ μ‹¤ν–‰λλ” λ°±μ—”λ“μ— μ”μ²­μ„ λ³΄λ‚΄λ ¤κ³  ν•λ©΄, λΈλΌμ°μ €κ°€ κΈ°λ³Έμ μΌλ΅ μ°¨λ‹¨ν•©λ‹λ‹¤.

μ΄κ²ƒμ€ λ§μΉ μ•„ννΈ κ²½λΉ„μ‹¤κ³Ό κ°™μµλ‹λ‹¤. λ‹¤λ¥Έ λ™μ—μ„ μ¨ μ‚¬λμ€ κΈ°λ³Έμ μΌλ΅ μ¶μ…μ„ λ§‰μ§€λ§, λ―Έλ¦¬ λ“±λ΅λ μ‚¬λ(ν—μ©λ μ¶μ²)μ€ λ“¤μ–΄μ¬ μ μκ² ν•λ” κ²ƒμ…λ‹λ‹¤.

### ν™κ²½ λ³€μ μ‚¬μ©
μ„¤μ • κ°’λ“¤μ„ μ½”λ“μ— μ§μ ‘ μ“°μ§€ μ•κ³  ν™κ²½ λ³€μ(.env νμΌ)μ—μ„ κ°€μ Έμ¤λ„λ΅ ν–μµλ‹λ‹¤. μ΄λ ‡κ² ν•λ©΄:
- κ°λ° ν™κ²½κ³Ό μ΄μ ν™κ²½μ—μ„ λ‹¤λ¥Έ μ„¤μ •μ„ μ‰½κ² μ‚¬μ©ν•  μ μμµλ‹λ‹¤
- λ³΄μ•μ— λ―Όκ°ν• μ •λ³΄(λΉ„λ°€λ²νΈ λ“±)λ¥Ό μ½”λ“μ— λ…Έμ¶ν•μ§€ μ•μ„ μ μμµλ‹λ‹¤

---

## μ–΄λ–»κ² μ‘λ™ν•λ‚μ”?

### 1. μ•± μ‹μ‘ κ³Όμ •
```
μ„λ²„ μ‹μ‘
  β†“
ν™κ²½ λ³€μ λ΅λ“ (APP_NAME, APP_VERSION, CORS_ORIGINS λ“±)
  β†“
FastAPI μ•± μƒμ„± (μ λ©, λ²„μ „ μ„¤μ •)
  β†“
CORS λ―Έλ“¤μ›¨μ–΄ μ¶”κ°€ (ν”„λ΅ νΈμ—”λ“ ν†µμ‹  ν—μ©)
  β†“
μ—”λ“ν¬μΈνΈ λ“±λ΅ (/, /health)
  β†“
μ„λ²„ μ‹¤ν–‰ λ€κΈ° (ν¬νΈ 8000)
```

### 2. CORS μ²λ¦¬ νλ¦„
ν”„λ΅ νΈμ—”λ“μ—μ„ μ”μ²­μ΄ μ¤λ©΄:
1. μ”μ²­μ μ¶μ²(`Origin` ν—¤λ”)λ¥Ό ν™•μΈν•©λ‹λ‹¤
2. ν—μ©λ μ¶μ² λ©λ΅(`CORS_ORIGINS`)κ³Ό λΉ„κµν•©λ‹λ‹¤
3. μΌμΉν•λ©΄ μ‘λ‹µ ν—¤λ”μ— `Access-Control-Allow-Origin`μ„ μ¶”κ°€ν•©λ‹λ‹¤
4. ν”„λ΅ νΈμ—”λ“κ°€ μ‘λ‹µμ„ λ°›μ„ μ μκ² λ©λ‹λ‹¤

### 3. ν—¬μ¤ μ²΄ν¬
`GET /health` μ—”λ“ν¬μΈνΈλ”:
- μ„λ²„κ°€ μ‚΄μ•„μλ”μ§€ ν™•μΈ (`status: "healthy"`)
- ν„μ¬ μ‹κ° λ°ν™ (`timestamp`)
- λ²„μ „ μ •λ³΄ μ κ³µ (`version`)

μ΄κ²ƒμ€ λ³‘μ›μ λ§¥λ°• μ²΄ν¬μ™€ κ°™μµλ‹λ‹¤. μ •κΈ°μ μΌλ΅ ν™•μΈν•΄μ„ μ„λ²„κ°€ μ •μƒμΈμ§€ λ¨λ‹ν„°λ§ν•  μ μμµλ‹λ‹¤.

---

## TDD μ‚¬μ΄ν΄μ€ μ–΄λ–»κ² μ§„ν–‰ν–λ‚μ”?

### π”΄ RED λ‹¨κ³„
λ¨Όμ € 7κ°€μ§€ ν…μ¤νΈλ¥Ό μ‘μ„±ν–μµλ‹λ‹¤:
1. μ•±μ΄ μ λ€λ΅ μƒμ„±λλ”κ°€?
2. CORS λ―Έλ“¤μ›¨μ–΄κ°€ μ„¤μ •λμ—λ”κ°€?
3. `/health` μ—”λ“ν¬μΈνΈκ°€ 200μ„ λ°ν™ν•λ”κ°€?
4. `/` μ—”λ“ν¬μΈνΈκ°€ API μ •λ³΄λ¥Ό λ°ν™ν•λ”κ°€?
5. CORS ν—¤λ”κ°€ μ‘λ‹µμ— ν¬ν•¨λλ”κ°€?
6. CORS preflight μ”μ²­μ„ μ²λ¦¬ν•λ”κ°€?
7. μ•± μΆ…λ£ μ‹ μ •λ¦¬κ°€ λλ”κ°€?

ν…μ¤νΈλ¥Ό μ‹¤ν–‰ν•λ©΄ λ¨λ‘ μ‹¤ν¨ν–μµλ‹λ‹¤ (μ•„μ§ `src/main.py`κ°€ μ—†μΌλ―€λ΅).

### πΆ GREEN λ‹¨κ³„
μµμ†ν•μ μ½”λ“λ΅ ν…μ¤νΈλ¥Ό ν†µκ³Όμ‹μΌ°μµλ‹λ‹¤:
- `backend/src/main.py` μƒμ„±
- FastAPI μ•± μΈμ¤ν„΄μ¤ μƒμ„±
- CORS λ―Έλ“¤μ›¨μ–΄ μ¶”κ°€
- `/health`μ™€ `/` μ—”λ“ν¬μΈνΈ κµ¬ν„

μ²μμ—λ” CORS λ―Έλ“¤μ›¨μ–΄ ν…μ¤νΈκ°€ μ‹¤ν¨ν–μ§€λ§, ν…μ¤νΈ λ΅μ§μ„ μμ •ν•μ—¬ ν†µκ³Όμ‹μΌ°μµλ‹λ‹¤.

λ¨λ“  ν…μ¤νΈκ°€ ν†µκ³Όν–μµλ‹λ‹¤! β…

### π”µ REFACTOR λ‹¨κ³„
μ½”λ“ ν’μ§μ„ κ°μ„ ν–μµλ‹λ‹¤:
1. Ruff λ¦°ν„°λ΅ μ½”λ“ κ²€μ‚¬
2. μ‚¬μ©ν•μ§€ μ•λ” `JSONResponse` import μ κ±°
3. `timezone.utc`λ¥Ό `UTC`λ΅ λ³€κ²½ (Python 3.11+ κ¶μ¥ λ°©μ‹)

λ¨λ“  ν…μ¤νΈκ°€ μ—¬μ „ν ν†µκ³Όν•λ”μ§€ ν™•μΈν–μµλ‹λ‹¤.

---

## κ΄€λ ¨ κ°λ…

### FastAPI
PythonμΌλ΅ λ§λ“  ν„λ€μ μΈ μ›Ή ν”„λ μ„μ›ν¬μ…λ‹λ‹¤. λΉ λ¥΄κ³  μ‚¬μ©ν•κΈ° μ‰¬μ°λ©°, μλ™μΌλ΅ API λ¬Έμ„λ¥Ό μƒμ„±ν•΄μ¤λ‹λ‹¤.

### CORS (Cross-Origin Resource Sharing)
λ‹¤λ¥Έ μ¶μ²μ—μ„ μ¨ μ”μ²­μ„ ν—μ©ν•λ” λ³΄μ• λ©”μ»¤λ‹μ¦μ…λ‹λ‹¤. μ›Ή λ³΄μ•μ κΈ°λ³Έ μ›μΉ™μΈ 'κ°™μ€ μ¶μ² μ •μ±…'μ μμ™Έλ¥Ό λ§λ“­λ‹λ‹¤.

### λ―Έλ“¤μ›¨μ–΄
μ”μ²­κ³Ό μ‘λ‹µ μ‚¬μ΄μ—μ„ λ™μ‘ν•λ” μ¤‘κ°„ μ²λ¦¬ κ³„μΈµμ…λ‹λ‹¤. λ§μΉ μμ‹μ μ μ„λΉ™ μ§μ›μ²λΌ, μ£Όλ¬Έμ΄ μ£Όλ°©μ— κ°€κΈ° μ „κ³Ό μμ‹μ΄ λ‚μ¤κΈ° μ „μ— ν•„μ”ν• μ²λ¦¬λ¥Ό ν•©λ‹λ‹¤.

### ν™κ²½ λ³€μ
μ΄μμ²΄μ λ‚ μ‹¤ν–‰ ν™κ²½μ—μ„ μ„¤μ •ν•λ” κ°’λ“¤μ…λ‹λ‹¤. μ½”λ“λ¥Ό λ³€κ²½ν•μ§€ μ•κ³ λ„ λ‹¤λ¥Έ μ„¤μ •μΌλ΅ ν”„λ΅κ·Έλ¨μ„ μ‹¤ν–‰ν•  μ μκ² ν•΄μ¤λ‹λ‹¤.

---

## μ£Όμμ‚¬ν•­

1. **ν™κ²½ λ³€μ ν•„μ**
   - `APP_NAME`, `APP_VERSION`, `CORS_ORIGINS` λ“±μ΄ `.env` νμΌμ— μ„¤μ •λμ–΄ μμ–΄μ•Ό ν•©λ‹λ‹¤
   - μ—†μΌλ©΄ κΈ°λ³Έκ°’μ„ μ‚¬μ©ν•μ§€λ§, λ…μ‹μ μΌλ΅ μ„¤μ •ν•λ” κ²ƒμ΄ μΆ‹μµλ‹λ‹¤

2. **CORS λ³΄μ•**
   - μ΄μ ν™κ²½μ—μ„λ” `CORS_ORIGINS`λ¥Ό μ‹ λΆ°ν•  μ μλ” λ„λ©”μΈμΌλ΅λ§ μ ν•ν•΄μ•Ό ν•©λ‹λ‹¤
   - `*` (λ¨λ“  μ¶μ² ν—μ©)μ€ κ°λ° μ‹μ—λ§ μ‚¬μ©ν•μ„Έμ”

3. **ν—¬μ¤ μ²΄ν¬ ν™μ©**
   - λ΅λ“ λ°Έλ°μ„λ‚ λ¨λ‹ν„°λ§ λ„κµ¬μ—μ„ `/health`λ¥Ό μ£ΌκΈ°μ μΌλ΅ νΈμ¶ν•μ—¬ μ„λ²„ μƒνƒλ¥Ό ν™•μΈν•  μ μμµλ‹λ‹¤

---

## λ‹¤μ λ‹¨κ³„

μ΄μ  FastAPI μ•±μ κΈ°λ³Έ κµ¬μ΅°κ°€ μ™„μ„±λμ—μµλ‹λ‹¤. λ‹¤μ μ‘μ—…λ“¤μ΄ ν•„μ”ν•©λ‹λ‹¤:

1. **T015**: API λΌμ°ν„° κµ¬μ΅° μƒμ„± (`/api/v1` κ²½λ΅)
2. **T016**: μ—λ¬ μ²λ¦¬ λ―Έλ“¤μ›¨μ–΄ κµ¬ν„
3. **T017**: Celery μ•±κ³Ό Redis μ—°κ²° μ„¤μ •

μ΄ μ‘μ—…λ“¤μ΄ μ™„λ£λλ©΄ μ‹¤μ  κΈ°λ¥(μΈμ¦, ν”„λ΅μ νΈ κ΄€λ¦¬, μ½”λ“ μ—…λ΅λ“ λ“±)μ„ κµ¬ν„ν•  μ¤€λΉ„κ°€ μ™„λ£λ©λ‹λ‹¤.

---

## μμ •λ νμΌ

### μƒμ„±λ νμΌ
- `backend/src/main.py` - FastAPI μ•± λ©”μΈ νμΌ
- `backend/tests/unit/test_main.py` - μ λ‹› ν…μ¤νΈ

### μ»¤λ°‹ νμ¤ν† λ¦¬
1. `test: Task 014 - FastAPI app initialization - RED` - μ‹¤ν¨ν•λ” ν…μ¤νΈ μ‘μ„±
2. `feat: Task 014 - FastAPI app initialization - GREEN` - κΈ°λ¥ κµ¬ν„μΌλ΅ ν…μ¤νΈ ν†µκ³Ό
3. `refactor: Task 014 - FastAPI app initialization - REFACTOR` - μ½”λ“ ν’μ§ κ°μ„ 

---

**ν…μ¤νΈ κ²°κ³Ό**: β… 7κ° ν…μ¤νΈ λ¨λ‘ ν†µκ³Ό
**μ½”λ“ μ»¤λ²„λ¦¬μ§€**: 100% (main.py)
**Ruff λ¦°ν„°**: β… λ¨λ“  κ²€μ‚¬ ν†µκ³Ό
